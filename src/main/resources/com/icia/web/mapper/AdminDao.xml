<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.icia.web.dao.AdminDao">

<!-- 유저 관리 -->

<resultMap type="com.icia.web.model.UserG2" id="userResultMap"> 
   <id column="USER_ID" property="userId" /> 
   <result column="USER_PWD" property="userPwd" />
   <result column="USER_EMAIL" property="userEmail" />
   <result column="USER_NAME" property="userName" />
   <result column="USER_NICKNAME" property="userNickName" />
   <result column="USER_PH" property="userPh" />
   <result column="USER_GEN" property="userGen" />
   <result column="USER_BIR" property="userBir" />
   <result column="STATUS" property="status" />
   <result column="REG_DATE" property="regDate" />
   <result column="UPDATE_DATE" property="updateDate" />
   <result column="USER_ADDRESS" property="userAddress" />
</resultMap>

<select id="userList" parameterType="com.icia.web.model.UserG2" resultMap="userResultMap">
SELECT USER_ID,
       USER_PWD,
       USER_EMAIL,       
       USER_NAME,
       USER_NICKNAME,
       USER_PH,
       USER_GEN,
       USER_BIR,
       STATUS,
       REG_DATE,
       UPDATE_DATE,
       USER_ADDRESS
  FROM (SELECT ROWNUM AS RNUM,
               USER_ID,
               USER_PWD,
               USER_EMAIL,       
               USER_NAME,
               USER_NICKNAME,
               USER_PH,
               USER_GEN,
               USER_BIR,
               STATUS,
               REG_DATE,
               UPDATE_DATE,
               USER_ADDRESS
          FROM (SELECT USER_ID,
                       NVL(USER_PWD, '') AS USER_PWD,
                       NVL(USER_EMAIL, '') AS USER_EMAIL,
                       NVL(USER_NAME, '') AS USER_NAME,
                       NVL(USER_NICKNAME, '') AS USER_NICKNAME,
                       NVL(USER_PH, '') AS USER_PH,
                       NVL(USER_GEN, '') AS USER_GEN,
                       NVL(USER_BIR, '') AS USER_BIR,
                       NVL(STATUS, 'N') STATUS,
                       NVL(TO_CHAR(REG_DATE, 'YYYY.MM.DD HH24:MI:SS'), '') AS REG_DATE,
                       NVL(TO_CHAR(UPDATE_DATE, 'YYYY.MM.DD HH24:MI:SS'), '') AS UPDATE_DATE,
                       NVL(USER_ADDRESS, '') AS USER_ADDRESS
                  FROM G2_USER
                 WHERE 1 = 1
                 <if test='userId != null and userId != ""'>
                   AND USER_ID LIKE '%' || #{userId} || '%'
                   </if>
                   <if test='userName != null and userName != ""'>
                   AND USER_NAME LIKE '%' || #{userName} || '%'
                 </if>  
                 <if test='status != "null" and status != ""'>
                   AND STATUS LIKE '%' || #{status} || '%'
                 </if>
                 ORDER BY REG_DATE DESC))
    WHERE RNUM <![CDATA[>=]]> #{startRow}
    AND RNUM <![CDATA[<=]]> #{endRow}
</select>

<select id="userListCount" parameterType="com.icia.web.model.UserG2" resultType="int">
SELECT COUNT(USER_ID) AS CNT
  FROM G2_USER
 WHERE 1 = 1
 <if test='userId != null and userId !=""'>
   AND USER_ID LIKE '%' || #{userId} || '%'
 </if>  
 <if test='userName != null and userName != ""'>
   AND USER_NAME LIKE '%' || #{userName} || '%'
 </if>  
 <if test='status != null and userName != ""'>
   AND STATUS LIKE '%' || #{status} || '%'
 </if>
</select>

<select id="userSelect" parameterType="string" resultMap="userResultMap">
SELECT USER_ID,
       NVL(USER_PWD, '') AS USER_PWD,
       NVL(USER_EMAIL, '') AS USER_EMAIL,
       NVL(USER_NAME, '') AS USER_NAME,
       NVL(USER_NICKNAME, '') AS USER_NICKNAME,
       NVL(USER_PH, '') AS USER_PH,
       NVL(USER_GEN, '') AS USER_GEN,
       NVL(USER_BIR, '') AS USER_BIR,
       NVL(STATUS, 'N') STATUS,
       NVL(TO_CHAR(REG_DATE, 'YYYY.MM.DD HH24:MI:SS'), '') AS REG_DATE,
       NVL(TO_CHAR(UPDATE_DATE, 'YYYY.MM.DD HH24:MI:SS'), '') AS UPDATE_DATE,
       NVL(USER_ADDRESS, '') AS USER_ADDRESS
  FROM G2_USER
 WHERE USER_ID = #{value}
 
 
</select>

<update id="userUpdate" parameterType="com.icia.web.model.UserG2"> 
UPDATE G2_USER 
   SET USER_NICKNAME = #{userNickName},
       STATUS = #{status},
       UPDATE_DATE = SYSDATE
 WHERE USER_ID = #{userId}
</update>


<!-- 판매자 관리 -->

<resultMap type="com.icia.web.model.Seller" id="sellerResultMap"> 
   <id column="SELLER_ID" property="sellerId" /> 
   <result column="BUSINESS_ID" property="sellerBusinessId" />
   <result column="USER_EMAIL" property="sellerEmail" />
   <result column="SELLER_PWD" property="sellerPwd" />
   <result column="SELLER_SHOP_NAME" property="sellerShopName" />
   <result column="SELLER_PH" property="sellerPh" />
   <result column="SELLER_ADDRESS" property="sellerAddress" />
   <result column="REG_DATE" property="regDate" />
   <result column="STATUS" property="status" />
</resultMap>

<select id="sellerList" parameterType="com.icia.web.model.Seller" resultMap="sellerResultMap">
SELECT SELLER_ID,
       BUSINESS_ID,
       USER_EMAIL,
       SELLER_PWD,
       SELLER_SHOP_NAME,
       SELLER_PH,
       SELLER_ADDRESS,
       REG_DATE,
       STATUS
  FROM (SELECT ROWNUM AS RNUM,
               SELLER_ID,
               BUSINESS_ID,
               USER_EMAIL,
               SELLER_PWD,
               SELLER_SHOP_NAME,
               SELLER_PH,
               SELLER_ADDRESS,
               REG_DATE,
               STATUS
          FROM (SELECT SELLER_ID,
                       NVL(BUSINESS_ID, '') AS BUSINESS_ID,
                       NVL(USER_EMAIL, '') AS USER_EMAIL,
                       NVL(SELLER_PWD, '') AS SELLER_PWD,
                       NVL(SELLER_SHOP_NAME, '') AS SELLER_SHOP_NAME,
                       NVL(SELLER_PH, '') AS SELLER_PH,
                       NVL(SELLER_ADDRESS, '') AS SELLER_ADDRESS,
                       NVL(TO_CHAR(REG_DATE, 'YYYY.MM.DD HH24:MI:SS'), '') AS REG_DATE,
                       NVL(STATUS, 'N') STATUS
                  FROM G2_SELLER
                 WHERE 1 = 1
                 <if test='sellerId != null and sellerId != ""'>
                   AND SELLER_ID LIKE '%' || #{sellerId} || '%'
                 </if>
                   <if test='sellerShopName != null and sellerShopName != ""'>  
                   AND SELLER_SHOP_NAME LIKE '%' || #{sellerShopName} || '%'
                 </if>  
                 <if test='status != "null" and status != ""'>  
                   AND STATUS LIKE '%' || #{status} || '%'
                 </if>
                 ORDER BY REG_DATE DESC))               
    WHERE RNUM <![CDATA[>=]]> #{startRow}
    AND RNUM <![CDATA[<=]]> #{endRow}
    
</select>

<select id="sellerListCount" parameterType="com.icia.web.model.Seller" resultType="int">
SELECT COUNT(SELLER_ID) AS CNT
  FROM G2_SELLER
 WHERE 1 = 1
 <if test='sellerId != null and sellerId !=""'>
   AND SELLER_ID LIKE '%' || #{sellerId} || '%'
 </if>  
 <if test='sellerShopName != null and sellerShopName != ""'>
   AND SELLER_SHOP_NAME LIKE '%' || #{sellerShopName} || '%'
 </if>  
 <if test='status != null and sellerBusinessId != ""'>
   AND STATUS LIKE '%' || #{status} || '%'
 </if>
</select>

<select id="sellerSelect" parameterType="string" resultMap="sellerResultMap">
SELECT SELLER_ID,
       NVL(BUSINESS_ID, '') AS BUSINESS_ID,
       NVL(USER_EMAIL, '') AS USER_EMAIL,
       NVL(SELLER_PWD, '') AS SELLER_PWD,
       NVL(SELLER_SHOP_NAME, '') AS SELLER_SHOP_NAME,
       NVL(SELLER_PH, '') AS SELLER_PH,
       NVL(SELLER_ADDRESS, '') AS SELLER_ADDRESS,
       NVL(TO_CHAR(REG_DATE, 'YYYY.MM.DD HH24:MI:SS'), '') AS REG_DATE,
       NVL(STATUS, 'N') STATUS
  FROM G2_SELLER
 WHERE SELLER_ID = #{value}
</select>

<update id="sellerUpdate" parameterType="com.icia.web.model.Seller"> 
UPDATE G2_SELLER 
   SET SELLER_SHOP_NAME = #{sellerShopName},
       STATUS = #{status}
 WHERE SELLER_ID = #{sellerId}
</update>


</mapper>